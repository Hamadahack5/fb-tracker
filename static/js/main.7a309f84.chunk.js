(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{168:function(e,t,a){e.exports=a(300)},300:function(e,t,a){"use strict";a.r(t);var n=a(1),o=a.n(n),s=a(42),l=a.n(s),i=a(65),c=a(66),r=a(133),u=a(67),m=a(134),d=a(23),p=a(308),g=a(307),h=a(315),f=a(316),k=a(135),v=a(311),E=a(309),b=a(310),w=a(314),S=a(313),_=function(e){function t(){return Object(i.a)(this,t),Object(r.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return o.a.createElement(S.a,null,o.a.createElement(S.a.Content,{header:this.props.header},this.props.pageName,o.a.createElement(S.a.Meta,null,this.props.created_time)),o.a.createElement(S.a.Content,null,o.a.createElement("p",null,o.a.createElement("strong",null,this.props.name)),o.a.createElement("p",null,this.props.message)),o.a.createElement(S.a.Content,null,o.a.createElement(g.a,null,o.a.createElement(h.a,{columns:2},o.a.createElement(h.a.Row,null,o.a.createElement(h.a.Column,{textAlign:"center"},"Impressions",o.a.createElement("p",null,this.props.impressions.toLocaleString())),o.a.createElement(h.a.Column,{textAlign:"center"},"Reach",o.a.createElement("p",null,this.props.reach.toLocaleString())))))),o.a.createElement(S.a.Content,{extra:!0},o.a.createElement("a",{href:this.props.link,target:"_blank",rel:"noopener noreferrer"},o.a.createElement(w.a,{basic:!0,color:"blue",content:"View"}))))}}]),t}(n.Component),y=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(r.a)(this,Object(u.a)(t).call(this,e))).addToList=function(e){e.preventDefault(),a.getMetrics(a.state.currentValue)},a.getMetricsRefresh=function(e){var t,n;a.setState({loading:!0}),a.state.facebookData.forEach(function(a){e.pageId===a.value&&(t=a)}),window.FB.api("/".concat(e.pageId,"_").concat(e.postId,"/?fields=insights.metric(post_impressions,post_impressions_unique,post_activity),name,message,created_time"),{access_token:t.access_token},function(o){n={link:e.link,postId:e.postId,pageId:t.value,pageName:t.text,name:o.name,message:o.message,created_time:new Date(o.created_time).toLocaleString("en-SG"),impressions:o.insights.data[0].values[0].value,reach:o.insights.data[1].values[0].value,engagement:o.insights.data[2].values[0].value};var s=a.state.links;s.push(n),a.setState({links:s}),a.saveToLocalStorage(),a.populateList(),a.setState({loading:!1})})},a.getMetrics=function(e){var t,n,o=e.split("/").pop();a.state.facebookData.forEach(function(e){a.state.currentPage===e.value&&(t=e)}),window.FB.api("/".concat(t.value,"_").concat(o,"/?fields=insights.metric(post_impressions,post_impressions_unique,post_activity),name,message,created_time"),{access_token:t.access_token},function(s){n={link:e,postId:o,pageId:t.value,pageName:t.text,name:s.name,message:s.message,created_time:new Date(s.created_time).toLocaleString("en-SG"),impressions:s.insights.data[0].values[0].value,reach:s.insights.data[1].values[0].value,engagement:s.insights.data[2].values[0].value};var l=a.state.links;l.push(n),a.setState({links:l}),a.saveToLocalStorage(),a.populateList()})},a.handleInputChange=function(e){a.setState({currentValue:e.target.value.split("?")[0]})},a.handleDropdownChange=function(e,t){var n=t.value;a.setState({currentPage:n})},a.state={currentValue:"",currentPage:"",links:[],oldLinks:[],facebookData:[],items:[],loading:!1},a.loadFacebook=a.loadFacebook.bind(Object(d.a)(Object(d.a)(a))),a.clearLocalStorage=a.clearLocalStorage.bind(Object(d.a)(Object(d.a)(a))),a.addToList=a.addToList.bind(Object(d.a)(Object(d.a)(a))),a.forceRefresh=a.forceRefresh.bind(Object(d.a)(Object(d.a)(a))),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.getFromLocalStorage(),this.loadFacebook()}},{key:"loadFacebook",value:function(){var e=this;!function(e,t,a){var n,o=e.getElementsByTagName(t)[0];e.getElementById(a)||((n=e.createElement(t)).id=a,n.src="https://connect.facebook.net/en_US/sdk.js",o.parentNode.insertBefore(n,o))}(document,"script","facebook-jssdk"),window.fbAsyncInit=function(){window.FB.init({appId:"1497929310342175",autoLogAppEvents:!0,xfbml:!0,version:"v3.2",state:!0}),e.loginFacebook()}}},{key:"loginFacebook",value:function(){var e=this;window.FB.getLoginStatus(function(t){"connected"===t.status?window.FB.api("/me/accounts?fields=name,access_token",function(t){e.setState({facebookData:t.data}),e.populateSelect()}):console.log("Login Failed!")})}},{key:"clearLocalStorage",value:function(){window.confirm("Clear all history?")&&(localStorage.clear(),this.setState({links:[]}))}},{key:"getFromLocalStorage",value:function(){if(localStorage.hasOwnProperty("links")){var e=localStorage.getItem("links");this.setState({links:JSON.parse(e)})}else this.setState({links:[]})}},{key:"saveToLocalStorage",value:function(){localStorage.setItem("links",JSON.stringify(this.state.links))}},{key:"loader",value:function(){return this.state.loading?o.a.createElement(p.a,{active:!0,inline:!0}):o.a.createElement(p.a,{disabled:!0,inline:!0})}},{key:"forceRefresh",value:function(){var e=this;this.setState({oldLinks:this.state.links,links:[]}),this.state.links.forEach(function(t){e.getMetricsRefresh(t)})}},{key:"populateSelect",value:function(){var e=[];this.state.facebookData.forEach(function(t){e.push({value:t.id,text:t.name,access_token:t.access_token})}),e.sort(function(e,t){return e.text.localeCompare(t.text)}),this.setState({facebookData:e})}},{key:"populateList",value:function(){var e=[];return this.state.links.forEach(function(t){e.push(o.a.createElement(_,{pageName:t.pageName,impressions:t.impressions,reach:t.reach,engagement:t.engagement,link:t.link,name:t.name,message:t.message,created_time:t.created_time}))}),e}},{key:"render",value:function(){return o.a.createElement("div",{className:"App"},o.a.createElement(g.a,null,o.a.createElement(h.a,{centered:!0,padded:!0,columns:1,divided:!0},o.a.createElement(h.a.Row,null,o.a.createElement(h.a.Column,null,o.a.createElement(f.a,{as:"h1",icon:!0,textAlign:"center"},o.a.createElement(k.a,{name:"facebook"}),o.a.createElement(f.a.Content,null,"Facebook Insights Tracker")),o.a.createElement("div",{className:"fb-login-button",style:{display:"block",textAlign:"center"},"data-size":"large","data-button-type":"continue_with","data-auto-logout-link":"true","data-use-continue-as":"true","data-scope":"read_insights, manage_pages"}))),o.a.createElement(h.a.Row,null,o.a.createElement(h.a.Column,null,o.a.createElement(v.a,{onSubmit:this.addToList},o.a.createElement(E.a,{defaultValue:this.state.currentValue,onChange:this.handleInputChange,fluid:!0,required:!0,placeholder:"Link",type:"url"},o.a.createElement("input",null),o.a.createElement(b.a,{placeholder:"Page",options:this.state.facebookData,onChange:this.handleDropdownChange}),o.a.createElement(w.a,{type:"submit"},o.a.createElement(k.a,{fitted:!0,name:"add"})))))),o.a.createElement(h.a.Row,null,o.a.createElement(h.a.Column,null,o.a.createElement(w.a,{content:"Clear History",onClick:this.clearLocalStorage}),o.a.createElement(w.a,{content:"Force Refresh",onClick:this.forceRefresh}),this.loader())),o.a.createElement(h.a.Row,null,o.a.createElement(h.a.Column,null,o.a.createElement(S.a.Group,{centered:!0,itemsPerRow:"3"},this.populateList()))))))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(296);l.a.render(o.a.createElement(y,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[168,2,1]]]);
//# sourceMappingURL=main.7a309f84.chunk.js.map